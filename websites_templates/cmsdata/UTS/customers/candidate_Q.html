<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <title> CustomersCandidatesDetail
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link href="formstyles.css" rel="stylesheet" type="text/css">
    <SCRIPT LANGUAGE="Javascript" type="text/javascript">
    <!--
    function hidestatus() {
        window.status = 'Otys e-Recruiting Systems'
        return true
    }
    if (document.layers)
        document.captureEvents(Event.MOUSEOVER | Event.MOUSEOUT)
    document.onmouseover = hidestatus
    document.onmouseout = hidestatus
        -->
    </SCRIPT>
</head>

<body>
    <!--uts:begin inner-->
    {if $stReachTextNotes}
    <script language="javascript" type="text/javascript" src="/_javascript_global/editor/TinyMCE/tiny_mce.js"></script>
    <script language="javascript" type="text/javascript">
    var intRid = parseInt('{$reactie.id}');

    //{literal}

    tinyMCE.init({
        theme: "advanced",
        mode: "exact",
        elements: "note",
        theme_advanced_toolbar_location: "top",
        theme_advanced_buttons1: "bold,italic,underline,strikethrough,separator," + "justifyleft,justifycenter,justifyright,justifyfull,formatselect," + "bullist,numlist,outdent,indent",
        theme_advanced_buttons2: "link,unlink,separator," + "undo,redo,separator,sub,sup,charmap",
        theme_advanced_buttons3: "",
        height: "200px",
        width: "100%"
    });


    function loadEvalNote(noteId) {
        var nid = parseInt(noteId);
        if (isNaN(nid)) {
            return false;
        }

        $.post('/index.php/page/cust_cand_note/', {
                command: 'get_note',
                note_id: nid,
                re_id: intRid
            },
            loadEvalNoteCB,
            'json');
    }

    // callback for loadEvalNote
    function loadEvalNoteCB(data) {
        var nid = parseInt(data.id);
        if (isNaN(nid)) {
            return false;
        }

        $('#note_id').val(nid);
        tinyMCE.get('note').setContent(data.note);

    }

    //{/literal}
    </script>
    {/if}
    <script language="Javascript1.2">
    var linemanager_extra_remarks = parseInt('{$linemanager_extra_remarks}');
    var trigger_timeslot_invite = '{$trigger_timeslot_invite}'; {
        literal
    }

    function check_formstate(tabcode) {
        layerShow(tabcode);
        //switch_tab(tabcode);
    }

    function printWindow() {
        browserVersion = parseInt(navigator.appVersion)
        if (browserVersion >= 4) window.print()
    }

    function request() {
        {
            /literal}
            location = '/index.php/page/CustomersRemote/bb/1/exp//command/prerequest/kid/{$candidate.id}'; {
                literal
            }
        }

        function print_it() {
            {
                /literal}
                //  document.frames.actionframe.location = '/index.php/page/CustomersRemote/bb/1/exp//command/detail/kid/{$kid}/option/print&amp;vid={$vid}';
                f = document.getElementById("actionframe");
                f.src = "/index.php/page/CustomersRemote/bb/1/exp//command/detail/kid/{$candidate.id}/option/print&amp;vid={$vid}"; {
                    literal
                }
            }


            function openRemarksForm() {

                allow_comments = false;
                ols = $('#old_status').val();
                olvs = $('#old_vb_procedures_status').val();
                olvs2 = $('#old_vb_procedures_status2').val();
                olvs3 = $('#old_vb_procedures_status3').val();
                ns = $('#status').val();
                nvs = $('#vb_procedures_status').val();
                nvs2 = $('#vb_procedures_status2').val();
                nvs3 = $('#vb_procedures_status3').val();
                if (ols != ns || olvs != nvs || olvs2 != nvs2 || olvs3 != nvs3) {
                    allow_comments = true;
                }


                if (allow_comments)
                    $('#dialog-form-extra-remarks').dialog('open');
                else
                //$('#candForm').submit();
                    candidate_form_submit();

            }

            function candidate_form_submit() {
                if (trigger_timeslot_invite == 1) {
                    timeslot_invite();
                } else {
                    $('#candForm').submit();
                }
            }

            $(document).ready(function() {

                if (linemanager_extra_remarks == 1) {
                    var linemanager_remarks = $("#linemanager_remarks"),
                        allExtraFields = $([]).add(linemanager_remarks),
                        tenTips = $(".validateTenTips");


                    function checkLength(o, n, min, max) {
                        if (o.val().length > max || o.val().length < min) {
                            o.addClass("ui-state-error");
                            updateTips('[th]Please add a comment[/th]' + n);
                            return false;
                        } else {
                            return true;
                        }
                    }

                    function updateTips(t) {
                        tenTips
                            .text(t)
                            .addClass("ui-state-highlight");
                        setTimeout(function() {
                            tenTips.removeClass("ui-state-highlight", 1500);
                        }, 500);
                    }

                    $("#dialog-form-extra-remarks").dialog({
                        modal: true,
                        autoOpen: false,
                        height: 250,
                        width: 500,
                        resizable: false,
                        buttons: {
                            "[th]Save[/th]": function() {
                                var bValid = true;
                                allExtraFields.removeClass("ui-state-error");

                                bValid = bValid && checkLength(linemanager_remarks, "", 1, 1000);


                                if (bValid) {

                                    $('#lm_remarks').val(linemanager_remarks.val());
                                    //$('#candForm').submit();
                                    candidate_form_submit();
                                }

                            },
                            "[th]Cancel[/th]": function() {
                                $(this).dialog("close");
                            }
                        }
                    });

                }

            });
            // Candidates appointment invitation
            function timeslot_invite() {
                if (trigger_timeslot_invite == 1) {

                    $(document).ready(function() {

                        status_changed = false;

                        olvs = $('#old_vb_procedures_status').val();
                        olvs2 = $('#old_vb_procedures_status2').val();
                        olvs3 = $('#old_vb_procedures_status3').val();

                        nvs = $('#vb_procedures_status').val();
                        nvs2 = $('#vb_procedures_status2').val();
                        nvs3 = $('#vb_procedures_status3').val();
                        if (olvs != nvs || olvs2 != nvs2 || olvs3 != nvs3) {
                            status_changed = true;
                        }


                        if (status_changed == true) {

                            $.post('/index.php/page/lm_timeslots/command/timeslotCheck',
                                $("#candForm").serialize(),
                                TimeslotFeedback,
                                'json');


                        }

                    });

                }
            }

            function TimeslotFeedback(data) {

                if (data.status == "OK" && data.popup == "show") {

                    var r = confirm("[th]Do you want to invite this candidate for an appointment?[/th]");
                    if (r == true) {
                        // save invitation
                        $.post('/index.php/page/lm_timeslots/command/timeslotSingleInvitationSaveInBackground',
                            $("#candForm").serialize(),
                            InvitationFeedback,
                            'html');

                    } else {
                        /// dont save invitation only continue...
                        $('#candForm').submit();
                    }


                } else {

                    $('#candForm').submit();
                }
            }

            function InvitationFeedback(data) {
                $('#candForm').submit();
            }
    </script>
    {/literal}
    <!-- /UTS/customers/candidate_Q.html -->
    <div class="header center">
        <h1>Votre fiche da {$candidate.name}  {$u.candidate_name|escape}</h1>
        <span class="right">{$picHtml}</span>
    </div>
    {if $customer_menu} {$customer_menu} {/if} {foreach from=$data item=record name=personal} {if $record.part=="PER"} {* Honza M.: A quick fix for translating - added here so that the UTSMAN sees the names, but in a always-false condition so that they are not displayed; FIXME: implement some kind of PHP hook, if record.name can be known in advance *} {if 0}
    <h2>These fields are generated dynamically ($record.name) - to be recognized by UTS, they must be inserted into a never-executed block, such as this one</h2> [ti]Voornaam[/ti]
    <br> [ti]Tussenvoegsel[/ti]
    <br> [ti]Achternaam[/ti]
    <br> [ti]Adres[/ti]
    <br> [ti]Woonplaats[/ti]
    <br> [ti]Mobiel[/ti]
    <br> [ti]Email[/ti]
    <br> [ti]Opleidingen[/ti]
    <br> [ti]Werkervaring[/ti]
    <br> [ti]Geboortedatum[/ti]
    <br> {/if}
    <h2>Télécharger le {$record.name}:{$record.value} </h2> {if $smarty.foreach.personal.first} {/if} {/if} {/foreach} {if $killerQuestions}
    <div class="custCandDtlKillerQuestions">
        <h2 class="subHeader">[t]Questions[/t]</h2>
        <div class="text">
            {foreach from=$killerQuestions item=kq} {if $kq.qq && $kq.qa}
            <div class="textWord kqQuestion">{$kq.qq|escape}</div>
            <div class="textWord kqAnswer">{$kq.qa|escape}</div>
            {/if} {/foreach}
        </div>
    </div>
    {/if} {if $candidateSocialNetworks}
    <div>[t]Social networks[/t]</div>
    <div>{foreach from=$socNetProfiles item=sn}
        <div class="socNetLogo">{if $sn.logo_url}
            <a href="{$sn.url}" target=_ "blank"><img src="{$sn.logo_url}" width="80" height="25" border="0" title="{$sn.network_type}"></a>{else}{$sn.network_type}{/if}</div>
        <div class="socNetLink"><a href="{$sn.url}" target=_ "blank">{if $sn.link_text}{$sn.link_text}{else}{$sn.url}{/if}</a></div>
    </div>
    {/foreach} {/if}
</body>

</html>
